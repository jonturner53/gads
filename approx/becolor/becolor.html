<html>
<head>
<title>Bounded Edge Coloring</title>
<link type="text/css" rel="stylesheet" href="../../main.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-41SPK9725S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-41SPK9725S');
</script>
</head>
<body bgcolor=ffffff>
\(
\newcommand{\color}{\textit{color}}
\newcommand{\avail}{\textit{avail}}
\newcommand{\np}{\textit{NP}}

\newcommand{\Proc}{\textbf{procedure}}
\newcommand{\Func}{\textbf{function}}
\newcommand{\flip}{\textit{flip}}
\newcommand{\bmax}{b_\texit{max}}

\newcommand{\proof}{\noindent\textit{proof}}

\newcommand{\ipar}{\begin{list}{\hbox{$\:$}}{} \item[] }
\newcommand{\rapi}{\end{list}}
\)

<h1>Bounded Edge Coloring<sup>&copy;</sup></h1>

The <i>bounded edge coloring problem</i> is a generalization of the
standard edge coloring problem, in which each edge $e$
has a <i>lower bound</i> $b(e)$ on its edge color.
The objective is to find an edge coloring that respects the lower
bounds and that minimizes the largest color assigned to any edge.

An example is shown below, where
the first number labelling each edge is its bound, while the second is
a valid color.
<p>
<p>
<div  style="text-align:center;">
<img width="20%" src="figs/example1.png"><br>
</div>
<p>
The problem is motivated by a scheduling problm in crossbar switches.
In this application, the graph's vertices represent the inputs and
outputs of a crossbar switch, while the edges represent packets to
be transferred from inputs to outputs.
The edge bounds represent the arrival times of the packets
and the colors represent the times at which packets are scheduled for 
transfer.
Since an input can only receive one packet at each time step,
the bounds on the edges incident to an input necessarily distinct.
This property is called the <i>unique input bounds condition</i>.
The example below shows a bipartite graph that satisfies the condition.
The tabular representation at right shows the inputs along the
rows and the outputs in the columns.
<p>
<div  style="text-align:center;">
<img width="40%" src="figs/example2.png"><br>
</div>
<p>
The problem was shown to by $\np$-complete in [Turner15], even when
restricted to bipartite graphs that satisfy the unique
input bounds condition. Consequently, it makes sense to focus
on approximate solutions.
<p>
The crossbar scheduling problem has been studied extensively in the
online context,
using several distinct performance criteria.
For so-called <i>input queued</i> switches,
the focus has been on ensuring bounded waiting times in systems
subjected to random input traffic.
Many scheduling algorithms have been shown to meet this 
objective~\cite{leonardi-01,mckeown-99a, mckeown-99b}.
More compelling, worst-case results have been shown for
<i>combined input and output queued</i>
switches, in which the crossbar is capable of transferring packets
somewhat faster than they can arrive at the inputs, or be transmitted
from the outputs.
Some scheduling algorithms can match the performance of an
idealized <i>output-queued</i>
switch when the crossbar is twice as fast as the inputs and 
outputs~\cite{attiya-06,chuang-99,krishna-99}.

<h2>Lower Bounds</h2>
In this section, we present several methods to compute lower bounds on the
maximum edge color used by an instance of the bounded edge-coloring problem. 
The first is referred to as the <i>degree bound</i>.
Before describing it, we need a few definitions.
For any vertex $u$ in a graph $G$, let $\delta_G(u)$ denote the number of edges incident to $u$
(the vertex degree) and let $\Delta_G=\max_u \delta_G (u)$.
If $G$ is an instance of the bounded edge coloring problem, we let $G^k$ be the subgraph
of $G$ containing edges with bounds $\geq k$ and we let $G_k$ be the subgraph
containing edges with bounds $\leq k$.
<p>
<div  style="text-align:center;">
<img width="40%" src="figs/example3.png"><br>
</div>
<p>

Observe that if a vertex $u$ has $d$ edges with bounds $\geq c$, then some edge
incident to $u$ must be assigned a color $\geq c+d-1$.
Consequently, for any $k$, the number of colors needed to color $G^k$ is at least
$k+\Delta_{G^k}-1$. The degree bound for $G$ is denoted $D(G)$ and defined by
$D(G)=\max_k k+\Delta_{G^k}-1$.
For the graph in Figure~\ref{example2}, $D=5$ and this graph can be colored using colors
$1,\ldots ,5$. 
Some graphs require more than $D$ colors.
Figure~\ref{example3} shows a graph (in the tablular format)
with $D=4$ that requires five colors
(an optimal coloring is shown in the second table).
<p>
The graph in Figure~\ref{example3} is actually a special case of a class of
graphs that require substantially more than $D$ colors. The graph $B_n$ has
inputs $u_1,\ldots,u_n$ and  outputs $v_1,\ldots,v_{2n-1}$.
For $1\leq i\leq n$, $1\leq j \leq i$, there is an edge $(u_i,v_j)$ with bound $j$,
and for each $1\leq i < n$, $i< j \leq n$, there is an edge $(u_i,v_{n+i})$
with bound $j$. Figure~\ref{example4} shows the case of $B_7$, along with
a coloring using nine colors. Note that in general, $D_{B_n}=n$.
<p>
<div  style="text-align:center;">
<img width="60%" src="figs/example4.png"><br>
</div>
<p>
Our second lower bound is obtained by computing a sequence of matchings.
Observe that for any integer $k$, the edges of $G$ that are colored $k$ must
form a matching in $G_k$.
If we let $m_k$ be the number of edges in a maximum size matching of $G_k$,
then $m_1+m_2+\cdots+m_k$ is an upper bound on the number of edges that
can be assigned colors in $1,\ldots,k$. If this sum is less than the number of edges in $G$,
then $G$ requires more than $k$ colors. So, if we let $M(G)$ be the smallest integer $k$
for which $m_1+m_2+\cdots+m_k$ is greater than or equal to the number of edges in $G$,
then $M(G)$ is a lower bound on the number of colors required to color $G$.
We refer to $M$ as the <i>matching bound</i>. For the graph $B_4$ in Figure~\ref{example3},
the sequence of matching sizes is $1, 3, 4, 4, 4$ and consequently, $M=5$.
For the graph $B_7$ in Figure~\ref{example4},
the sequence of matching sizes is $1, 3, 5, 7, 7, 7, 7,7,7$ 
and $M=9$. It's not difficult to show that
in general, the matching bound for $B_n$ is $\lceil 5n/4 \rceil$.
<p>
Now, we turn to our third lower bound.
Let $G=(V,E)$ be a bipartite graph with edge bounds $b(e)$
and let $c$ be a valid coloring of $G$ using colors $1,\ldots,C$.
Let $H_k$ be the subgraph of $G$ that
is colored using colors $1,\ldots,k$  and let
$J_k$ be the subgraph of $G$ that is colored using colors $k+1,\ldots,C$.
Note that $H_k$ is a subgraph of $G_k$, $D_{H_k} \leq k$ and $\Delta_{J_k} \leq C-k$.
So, for any $k$, it is possible to split $G$ into two subgraphs that have
these properties.
Now, let $C^\prime$ be an integer smaller than $C$ and
note that if there is some $k$, for which we cannot split $G$ into
subgraphs $H_k$ and $J_k$ with $H_k$ a subgraph of $G_k$,
$D_{H_k} \leq k$ and $\Delta_{J_k} \leq C^\prime-k$, then
$G$ cannot be colored using only colors $1,\ldots,C^\prime$.
This leads to a lower bound on the number of colors needed to color a given graph.
<p>
To make this bound useful, we need an efficient way to partition $G$
into subgraphs $H_k$ and $J_k$ for given integers $k$ and $C$. This can be done
by solving a network flow problem. Let $F_{k,C}$ be a <i>flow graph</i> that includes
a <i>source vertex</i> $s$, a <i>sink vertex</i> $t$ and a chain of vertices for each
vertex in $G_k$.
Specifically, for each input $u$ in $G_k$,
$F_{k,C}$ contains a chain consisting of vertices $u_i$ for each $i\in \{1,\ldots,k\}$
and edges $(u_i,u_{i+1})$ with <i>capacity</i> $k-i$.
There is also an edge from $s$ to $u_1$ with capacity $k$.
For each output $v$ in $G_k$,
$F_{k,C}$ contains a chain consisting of vertices $v_i$ for each $i\in \{1,\ldots,k\}$
and edges $(v_{i+1},v_{i})$ with <i>capacity</i> $k-i$.
There is also an edge from $v_1$ to $t$ with capacity $k$.
For each edge $(u,v)$ in $G_k$ with bound $i$, $F$ contains an edge $(u_i,v_i)$
of capacity 1.
We refer to this last set of edges as the <i>core edges</i> of $F_{k,C}$.
Observe that the subset of the core edges that have positive capacity in any integer flow 
on $F_{k,C}$ correspond to a subgraph of $G_k$ that has a degree bound $D$ that is no larger than $k$.
To complete the construction of $F_{k,C}$, we specify <i>minimum flow requirements</i> for the
edges incident to $s$ and $t$. In particular, for input $u$ of $G$,
the edge $(s,u_1)$ is assigned a minimum flow of $\min \{0,\delta_G(u)-(C - k)\}$.
Similarly, for output $v$ of $G$,
the edge $(v_1,t)$ is assigned a minimum flow of $\min \{0,\delta_G(v)-(C - k)\}$.
Given an integer flow on $F_k$ that satisfies the minimum flow requirements,
we define $H_k$ to consist of those edges in $G$ that correspond to
core edges that have positive flow. We define $J_k$ to include the remaining edges in $G$.
It is straightforward to show that $H_k$ is a subgraph of $G_k$, 
$D_{H_k} \leq k$ and $\Delta_{J_k} \leq C-k$.
If there is no integer flow on $F_k$ that satisfies the minimum flow requirements,
then $G$ cannot be colored using only colors $1,\ldots,C$.
<p>
<p>
<div  style="text-align:center;">
<img width="70%" src="figs/flowBound.png"><br>
</div>
<p>


Figure~\ref{flowBound} shows the graph $B_4$ and the corresponding
flow graph $F_{2,5}$. There is an integer flow for $F_{2,5}$ that
uses the edges that are emphasized in ``{\bf bold}'' and satisfies
all the minimum flow requirements. The edges of $B_4$ that correspond to the
bold core edges are also emphasized in bold. 
These edges define the graph $H_2$, while the remaining
edges define $J_2$. Note that $D_{H_2}=2$ and $\Delta_{J_2}=3$.
<p>
The <i>flow bound</i> for $G$ is denoted by $P_G$ and is defined as the smallest
value of $C$ for which $F_{k,C}$ has a flow that satisfies the minimum flow requirements,
for all values of $k\in[1,\bmax]$, where $\bmax$ is the 
largest edge bound in $G$.
The flow bound for $B_8$ is 11, while the matching bound is 10.
This gap increases for larger graphs. For example, $B_{64}$ has a
matching bound of 80 and a flow bound of 83, while
$B_{256}$ has a matching bound of 320 and a flow bound of 331.
<p>
We close this section by describing a general method for coloring
graphs $B_n$ using colors $1,\ldots,n+\lceil (n-1)/3 \rceil$.
For $B_{64}$ the largest color is 85, for $B_{256}$ the largest color is 341.
<p>
<div  style="text-align:center;">
<img width="60%" src="figs/colofB.png"><br>
</div>
<p>
Figure~\ref{colorB} illustrates the method for coloring $B_n$.
The top part of the figure shows the coloring given earlier for $B_7$,
with several regions of the table highlighted. Note that each of the
four highlighted regions uses a distinct set of colors and each color used is
repeated along a diagonal within the region. The edges incident to
the outputs $H,\ldots,M$ are assigned colors equal to their bounds.
The bottom part of the figure shows how the colors of the edges incident to the
first $n$ outputs are assigned in the general case, using a parameter $x=\lceil (n-1)/3 \rceil$.
Again, we divide the table definining the edges into four regions and assign
disjoint sets of colors to those regions. Within each region, colors are used repeatedly
along diagonals. The edges incident to the last $n-1$ outputs are assigned colors
equal to their bounds. The choice of $x$ ensures that the assignment of colors
to edges yields a legal coloring of the graph that respects all the edge bounds.

<h2>Approximate algorithms</h2>

In this section, we describe several approximate algorithms for the bounded
edge coloring problem and analyze their worst-case performance.
Let $G=(V,E)$ be a graph with edge bounds $b(e)$ and let $C^\ast (G)$ be
the largest color value used by an optimal solution.
<p>
We start with a very simple method that produces solutions with a
maximum color $\leq 2 C^\ast$.
Let $\bmax$ be the largest color bound used by an instance of the bounded
edge coloring problem and let $\Delta$ be the maximum vertex degree.
Using any method for the ordinary edge coloring problem, we can color
the edges using colors $\bmax,\ldots,\bmax+\Delta -1$ and since
$C^\ast\geq \max\{\bmax,\Delta\}$,
the largest color used by this solution is $<2C^\ast$.
<p>
We can get a better approximation by first spliting $G$ into two subgraphs
and coloring each of the subgraphs separately.
Consider an optimal coloring of $G$ and let $H_k$ be the subgraph defined by
the edges with colors $\leq k$. Note that $H_k$ is a subgraph of $G_k$ and
that $\Delta_{H_k}\leq k$. If we let $J_k$ be the subgraph of $G$ defined by
the edges with colors $>k$, then $\Delta_{J_k}\leq C^\ast - k$.
So an optimal coloring must be divisible into a pair of subgraphs that
satisfy these inequalities. Note that we can color $H_k$ using colors
$k,\ldots,2k-1$ using any algorithm for the ordinary edge coloring problem.
We can also color $J_k$ using colors $\bmax,\ldots,\bmax+C^\ast-(k+1)$.
So long as $2k-1<\bmax$, these two sets of colors do not overlap meaning that
we can color the entire graph using colors $k,\ldots,\bmax+C^\ast-(k+1)$.
If we let $k=\lfloor \bmax/2 \rfloor$, the largest color is
$\leq (\bmax/2)+C^\ast\leq (3/2)C^\ast$.
<p>
In order to construct an approximation algorithm based on this observation,
we need a way to split $G$ into subgraphs $H_k$ and $J_k$. This can be done
by solving the same flow problem that was used in the flow lower bound computation.
Alternatively, we can simplify the flow problem by collapsing each of the input-side
chains $u_1,\ldots,u_k$
into a single vertex $u$ and each of the output-side chains $v_1,\ldots,v_k$
into a single vertex $v$.
Thus, we can efficiently color any graph $G$ using colors 
$\leq (3/2)C^\ast$. We'll refer to this as the <i>splitting method</i>.
<p>
Our next algorithm is a simple greedy algorithm that repeats the following step until
all edges are colored.
\ipar
Select an edge $e=(u,v)$ and let $c$ be the smallest color that is at least as large as $b(e)$
and is not yet in use at both $u$ and $v$.
\rapi
We select edges that are incident to a vertex of maximum degree in the uncolored subgraph.
While we have no worst-case-performance
bound for this algorithm, in pactice it out-performs the splitting method, as we will see in the
next section.
<p>
Now, we consider an algorithm based on the classical augmenting path algorithm for the
ordinary edge coloring problem. For the bounded edge coloring problem, a path $p$
is an $ij$-<i>augmenting path</i> if its edges alternate in color between $i$ and $j$, it cannot
be extended any further at either of its endpoints and every edge in the path has a bound
that is $\leq \min\{i,j\}$. The <i>augmenting path algorithm</i> for the bounded edge coloring problem
colors the edges by repeatingly selecting an edge $e=(u,v)$ and then applying the first case from
the following list that applies.
\begin{itemize}
\item
 If there is some <i>eligible color</i> that is unused
at both endpoints, color $e$ with one such color.
\item
If there are eligible colors $i$ and $j$, where $i$ is available at $u$ and $j$ is available at $v$,
and there is an $ij$-augmenting path starting at $v$,
then reverse the colors of the edges on the path and and let $c(e)=i$.
\item
If there are eligible colors $i$ and $j$, where $i$ is available at $u$ and $j$ is available at $v$,
and there is a $ji$-augmenting path starting at $u$,
then reverse the colors of the edges on the path and let $c(e)=j$.
\item
Allocate a new eligible color and use it to color $e$.
\end{itemize}
Initially, colors $1,\ldots,\bmax$ are eligible. New colors are allocated sequentially, as needed.
We select edges that are incident to a vertex of maximum degree in the uncolored subgraph.
When selecting colors, we give preference to colors with smaller values.
In the first case, we select the smallest eligible color that is unused at both endpoints.
In the second and third cases, we select color pairs $i$ and $j$ that minimize $\max\{i,j\}$.
<p>
Since the augmenting path algorithm for the ordinary edge-coloring problem
uses $\Delta$ colors, this version colors uses no color larger than $\bmax+\Delta -1$.
We can also use it to color the subgraphs in the splitting method to obtain an algorithm 
that uses no color larger $(\bmax/2)+C^\ast$.
<p>
Next, we consider algorithms based on constructing a series of matchings.
The first such algorithm starts by initializing $k=1$ then repeating 
the following step so long as there are uncolored edges.
\ipar
Find a maximum size matching on the uncolored edges in $G_k$,
assign color $k$ to all edges in the matching, then increment $k$.
\rapi
We refer to this as the <i>maximum size matching</i> algorithm.
We can improve it by selecting matchings that maximize the number of matched
vertices that have maximum degree in the uncolored subgraph.
This can be done using an algorithm described in~\cite{tu15}.
This version of the matching algorithm is called the <i>maximum degree matching</i> algorithm.
Reference~\cite{tu15} also shows how to find maximum size matchings that 
maximize a general <i>priority score</i> based on arbitrary integer priorities assigned
to the vertices. Our third matching algorithm uses this method.
Priorities are assigned in decreasing order of vertex degree in the uncolored subgraph.
So, vertices of maximum degree are assigned priority 1, those with the next largest degree
are assigned priority 2 and so forth. We refer to this version of the matching algorithm
as the <i>priority matching</i> algorithm. The last two of the matching algorithms
use no color larger $\bmax+\Delta -1$. Also, like the augmenting path algorithm,
they can be used with the splitting method to obtain an algorithm 
that uses no color larger $(\bmax/2)+C^\ast$.

<h2>Experimental Evaluation</h2>

<p>
<div  style="text-align:center;">
<img width="40%" src="figs/randomchart.png"><br>
</div>
<p>

In this section, we evaluate the performance of the algorithms introduced in the
last section, experimentally. We start, by evaluating the performance using random graphs
that are generated using the following procedure.
\begin{itemize}
\item
Generate a random regular bipartite graph, with $n$ inputs, $n$ outputs and all
vertices having degree $\Delta$.
\item
At each input, assign the incident edges a unique random color in $1,\ldots,\bmax$,
where $\bmax \geq \Delta$
\end{itemize}
This produces a random problem instance that satisfies the unique input bounds condition.
Figure~\ref{randomchart} shows results for graphs on 100 vertices where the vertex degree
is varied from 5 to 50 and $\bmax=\Delta+3$. The $y$-axis displays the difference between
the maximum color used and the vertex degree. Each data point shows the average from ten
random problem instances. Error bars have been omitted for clarity, but the relative error
was generally less than 2\%.
<p>
The lowest curve shows the results for the flow lower bound and the priority matching algorithm
(for these graphs, the priority matching algorithm always produced results equal to the bound).
The maximum degree matching algorithm was almost identical to the priority matching algorithm,
but did occasionally exhibit small differences.
The maximum size matching algorithm was not quite as good as the other two.
The greedy and augmenting path algorithms also produced perfectly respectable results,
generally exceeding the largest color used by the priority matching algorithm by less than 5\%.
<p>
Figure~\ref{badcasechart} shows performance results for the graphs $B_n$.
Here the max degree and priority match algorithms generally use just 2 or 3 more
colors than the number given by the flow lower bound. The maximum size matching
algorithm performs less well in this case, actually under-performing the augmenting path
algorithm.
<p>
The algorithms described here are all available as part of an open-source library
of graph algorithms and data structures~\cite{tu15a}.

<p>
<div  style="text-align:center;">
<img width="20%" src="figs/badcasechart.png"><br>
</div>
<p>

<h2>Closing Remarks</h2>

The bounded edge-coloring problem is a natural generalization of the ordinary
edge-coloring problem and interesting in its own right, independent of its application to
the crossbar scheduling problem. There is a considerable gap between the best
worst-case performance ratio achieved by our algorithms and the experimental
performance measurements. Closing that gap is the main open problem to be addressed.
<p>
It's worth noting that most of our algorithms can be applied to general graphs,
as well as bipartite graphs. It would be interesting to understand how they perform
in this context. Unfortunately, the flow lower bound cannot be applied to general
graphs, although the degree bound and matching bound can be.
<p>
While our results do not apply directly to the online version of the crossbar scheduling
problem, there is potential for extending them to make them more applicable.
For example, one can model systems in which the crossbars operate at faster speeds
than the inputs and outputs by restricting the values allowed as edge bounds.
This can be used to derive a lower bound on the ``speedup ratio'' needed to
match the performance of an ideal output-queued switch.

\begin{thebibliography}{99}
\bibitem{attiya-06}
Attiya, H., D. Hay and I. Keslassy.
``Packet-Mode Emulation of Output-Queued Switches,''
{\sl Proc. of ACM SPAA}, 2006.

\bibitem{BM76}
Bondy, J. A. and U. S. R. Murty.
{\sl Graph Theory and Applications},
Elsevier North Holland, 1976.

\bibitem{CO84}
Colburn, Charles.
``The complexity of completing partial latin squares,''
{\sl Discrete Applied Mathematics} 8 (1984), pp. 25-30.

\bibitem{chuang-99}
Chuang, S.-T. A. Goel, N. McKeown, B. Prabhakar 
``Matching output queueing with a combined input output queued switch,''
{\sl IEEE J. on Selected Areas in Communications}, 12/1999.

\bibitem{krishna-99}
Krishna, P., N. Patel, A. Charny and R. Simcoe.
``On the speedup required for work-conserving crossbar switches,''
{\sl IEEE J. Selected Areas of Communications}, 6/1999.

\bibitem{leonardi-01}
Leonardi, E., M. Mellia, F. Neri, and M.A. Marsan,
``On the stability of input-queued switches with speed-up,''
{\sl IEEE/ACM Transactions on Networking},
Vol. 9, No. 1, pp. 104--118, 2/2001.

\bibitem{mckeown-99a}
McKeown, N. ``$i$SLIP: a scheduling algorithm for input-queued switches,''
{\sl IEEE Trans. on Networking}, 4/1999.

\bibitem{mckeown-99b}
McKeown, N., A. Mekkittikul, V. Anantharam, and J. Walrand.
``Achieving 100\% Throughput in an Input-Queued Switch,''
{\sl IEEE Trans. on Communications}, Vol. 47, No. 8, 8/1999.

\bibitem{tu15a}
Turner, Jonathan.
``Grafalgo - a library of graph algorithms and supporting data structures,''
{\sl Washington University Department of Computer Science and Engineering},
{\sc wucse-2015-01}, 1/2015.

\bibitem{tu15}
Turner, Jonathan.
``Maximum priority matchings,''
{\sl Washington University Department of Computer Science and Engineering},
{\sc wucse-2015-06}, 11/2015.

\end{thebibliography}
 
\end{document}

<hr> <h4>&copy; Jonathan Turner - 2023</h4>
<script src="../../googleAnalytics.js"></script>
</body>
</html>
